jest.mock('redux-saga');
import { mocked } from 'ts-jest/utils';
import { eventChannel } from 'redux-saga';
import NetInfo from '@react-native-community/netinfo';
import { createNetInfoConnectionChangeChannel, netInfoEventChannelFn, createIntervalChannel, intervalChannelFn, } from '../redux/sagas';
var netInfoUnsubscribe = jest.fn();
describe('createNetInfoConnectionChangeChannel', function () {
    it('returns a redux-saga channel', function () {
        var eventChannelMock = jest.fn().mockReturnValue('channel');
        mocked(eventChannel).mockImplementation(eventChannelMock);
        var mockNetInfoChannelFn = jest.fn().mockReturnValue('handlerFn');
        expect(createNetInfoConnectionChangeChannel(mockNetInfoChannelFn)).toBe('channel');
        expect(eventChannelMock).toHaveBeenCalledWith(mockNetInfoChannelFn);
    });
    it('netInfoEventChannelFn adheres to eventChannel cb interface', function () {
        var emitMock = jest.fn();
        NetInfo.addEventListener.mockReturnValueOnce(netInfoUnsubscribe);
        var unsubscribe = netInfoEventChannelFn(emitMock);
        expect(NetInfo.addEventListener).toHaveBeenCalledWith(emitMock);
        unsubscribe();
        expect(netInfoUnsubscribe).toHaveBeenCalledTimes(1);
    });
});
describe('createIntervalChannel', function () {
    var interval = 50;
    it('returns a redux-saga channel', function () {
        var eventChannelMock = jest.fn().mockReturnValue('channel');
        mocked(eventChannel).mockImplementation(eventChannelMock);
        var mockIntervalChannelFn = jest.fn().mockReturnValue('handlerFn');
        expect(createIntervalChannel(interval, mockIntervalChannelFn)).toBe('channel');
        expect(mockIntervalChannelFn).toHaveBeenCalledWith(interval);
        expect(eventChannel).toHaveBeenCalledWith('handlerFn');
    });
    it('intervalChannelFn adheres to eventChannel cb interface', function (done) {
        global.clearInterval = jest.fn();
        var emitMock = jest.fn();
        var unsubscribe = intervalChannelFn(interval)(emitMock);
        setTimeout(function () {
            expect(emitMock).toHaveBeenCalledWith(true);
            done();
        }, interval + 20);
        unsubscribe();
        expect(global.clearInterval).toHaveBeenCalled();
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL0RldkFDL0Rlc2t0b3AvQW5nYXphL3JlYWN0LW9mZmxpbmUtc3luYy9zcmMvdGVzdC9zYWdhQ2hhbm5lbHMudGVzdC50cyIsIm1hcHBpbmdzIjoiQUFVQSxJQUFJLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO0FBVnhCLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDdkMsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLFlBQVksQ0FBQztBQUMxQyxPQUFPLE9BQU8sTUFBTSxpQ0FBaUMsQ0FBQztBQUN0RCxPQUFPLEVBQ0wsb0NBQW9DLEVBQ3BDLHFCQUFxQixFQUNyQixxQkFBcUIsRUFDckIsaUJBQWlCLEdBQ2xCLE1BQU0sb0JBQW9CLENBQUM7QUFHNUIsSUFBTSxrQkFBa0IsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7QUFFckMsUUFBUSxDQUFDLHNDQUFzQyxFQUFFO0lBQy9DLEVBQUUsQ0FBQyw4QkFBOEIsRUFBRTtRQUNqQyxJQUFNLGdCQUFnQixHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDOUQsTUFBTSxDQUFDLFlBQVksQ0FBQyxDQUFDLGtCQUFrQixDQUFDLGdCQUFnQixDQUFDLENBQUM7UUFDMUQsSUFBTSxvQkFBb0IsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBQ3BFLE1BQU0sQ0FBQyxvQ0FBb0MsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUNyRSxTQUFTLENBQ1YsQ0FBQztRQUNGLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLG9CQUFvQixDQUFDLENBQUM7SUFDdEUsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsNERBQTRELEVBQUU7UUFDL0QsSUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO1FBQzFCLE9BQU8sQ0FBQyxnQkFBOEIsQ0FBQyxtQkFBbUIsQ0FDekQsa0JBQWtCLENBQ25CLENBQUM7UUFDRixJQUFNLFdBQVcsR0FBRyxxQkFBcUIsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUVwRCxNQUFNLENBQUMsT0FBTyxDQUFDLGdCQUFnQixDQUFDLENBQUMsb0JBQW9CLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDaEUsV0FBVyxFQUFFLENBQUM7UUFDZCxNQUFNLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUN0RCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDO0FBRUgsUUFBUSxDQUFDLHVCQUF1QixFQUFFO0lBQ2hDLElBQU0sUUFBUSxHQUFHLEVBQUUsQ0FBQztJQUNwQixFQUFFLENBQUMsOEJBQThCLEVBQUU7UUFDakMsSUFBTSxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQzlELE1BQU0sQ0FBQyxZQUFZLENBQUMsQ0FBQyxrQkFBa0IsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1FBQzFELElBQU0scUJBQXFCLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGVBQWUsQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUNyRSxNQUFNLENBQUMscUJBQXFCLENBQUMsUUFBUSxFQUFFLHFCQUFxQixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQ2pFLFNBQVMsQ0FDVixDQUFDO1FBQ0YsTUFBTSxDQUFDLHFCQUFxQixDQUFDLENBQUMsb0JBQW9CLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDN0QsTUFBTSxDQUFDLFlBQVksQ0FBQyxDQUFDLG9CQUFvQixDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ3pELENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLHdEQUF3RCxFQUFFLFVBQUEsSUFBSTtRQUMvRCxNQUFNLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQztRQUNqQyxJQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7UUFDM0IsSUFBTSxXQUFXLEdBQUcsaUJBQWlCLENBQUMsUUFBUSxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDMUQsVUFBVSxDQUFDO1lBQ1QsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzVDLElBQUksRUFBRSxDQUFDO1FBQ1QsQ0FBQyxFQUFFLFFBQVEsR0FBRyxFQUFFLENBQUMsQ0FBQztRQUNsQixXQUFXLEVBQUUsQ0FBQztRQUNkLE1BQU0sQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztJQUNsRCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9EZXZBQy9EZXNrdG9wL0FuZ2F6YS9yZWFjdC1vZmZsaW5lLXN5bmMvc3JjL3Rlc3Qvc2FnYUNoYW5uZWxzLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgbW9ja2VkIH0gZnJvbSAndHMtamVzdC91dGlscyc7XG5pbXBvcnQgeyBldmVudENoYW5uZWwgfSBmcm9tICdyZWR1eC1zYWdhJztcbmltcG9ydCBOZXRJbmZvIGZyb20gJ0ByZWFjdC1uYXRpdmUtY29tbXVuaXR5L25ldGluZm8nO1xuaW1wb3J0IHtcbiAgY3JlYXRlTmV0SW5mb0Nvbm5lY3Rpb25DaGFuZ2VDaGFubmVsLFxuICBuZXRJbmZvRXZlbnRDaGFubmVsRm4sXG4gIGNyZWF0ZUludGVydmFsQ2hhbm5lbCxcbiAgaW50ZXJ2YWxDaGFubmVsRm4sXG59IGZyb20gJy4uL3NyYy9yZWR1eC9zYWdhcyc7XG5cbmplc3QubW9jaygncmVkdXgtc2FnYScpO1xuY29uc3QgbmV0SW5mb1Vuc3Vic2NyaWJlID0gamVzdC5mbigpO1xuXG5kZXNjcmliZSgnY3JlYXRlTmV0SW5mb0Nvbm5lY3Rpb25DaGFuZ2VDaGFubmVsJywgKCkgPT4ge1xuICBpdCgncmV0dXJucyBhIHJlZHV4LXNhZ2EgY2hhbm5lbCcsICgpID0+IHtcbiAgICBjb25zdCBldmVudENoYW5uZWxNb2NrID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnY2hhbm5lbCcpO1xuICAgIG1vY2tlZChldmVudENoYW5uZWwpLm1vY2tJbXBsZW1lbnRhdGlvbihldmVudENoYW5uZWxNb2NrKTtcbiAgICBjb25zdCBtb2NrTmV0SW5mb0NoYW5uZWxGbiA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ2hhbmRsZXJGbicpO1xuICAgIGV4cGVjdChjcmVhdGVOZXRJbmZvQ29ubmVjdGlvbkNoYW5nZUNoYW5uZWwobW9ja05ldEluZm9DaGFubmVsRm4pKS50b0JlKFxuICAgICAgJ2NoYW5uZWwnLFxuICAgICk7XG4gICAgZXhwZWN0KGV2ZW50Q2hhbm5lbE1vY2spLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKG1vY2tOZXRJbmZvQ2hhbm5lbEZuKTtcbiAgfSk7XG5cbiAgaXQoJ25ldEluZm9FdmVudENoYW5uZWxGbiBhZGhlcmVzIHRvIGV2ZW50Q2hhbm5lbCBjYiBpbnRlcmZhY2UnLCAoKSA9PiB7XG4gICAgY29uc3QgZW1pdE1vY2sgPSBqZXN0LmZuKCk7XG4gICAgKE5ldEluZm8uYWRkRXZlbnRMaXN0ZW5lciBhcyBqZXN0Lk1vY2spLm1vY2tSZXR1cm5WYWx1ZU9uY2UoXG4gICAgICBuZXRJbmZvVW5zdWJzY3JpYmUsXG4gICAgKTtcbiAgICBjb25zdCB1bnN1YnNjcmliZSA9IG5ldEluZm9FdmVudENoYW5uZWxGbihlbWl0TW9jayk7XG5cbiAgICBleHBlY3QoTmV0SW5mby5hZGRFdmVudExpc3RlbmVyKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChlbWl0TW9jayk7XG4gICAgdW5zdWJzY3JpYmUoKTtcbiAgICBleHBlY3QobmV0SW5mb1Vuc3Vic2NyaWJlKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKCdjcmVhdGVJbnRlcnZhbENoYW5uZWwnLCAoKSA9PiB7XG4gIGNvbnN0IGludGVydmFsID0gNTA7XG4gIGl0KCdyZXR1cm5zIGEgcmVkdXgtc2FnYSBjaGFubmVsJywgKCkgPT4ge1xuICAgIGNvbnN0IGV2ZW50Q2hhbm5lbE1vY2sgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdjaGFubmVsJyk7XG4gICAgbW9ja2VkKGV2ZW50Q2hhbm5lbCkubW9ja0ltcGxlbWVudGF0aW9uKGV2ZW50Q2hhbm5lbE1vY2spO1xuICAgIGNvbnN0IG1vY2tJbnRlcnZhbENoYW5uZWxGbiA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ2hhbmRsZXJGbicpO1xuICAgIGV4cGVjdChjcmVhdGVJbnRlcnZhbENoYW5uZWwoaW50ZXJ2YWwsIG1vY2tJbnRlcnZhbENoYW5uZWxGbikpLnRvQmUoXG4gICAgICAnY2hhbm5lbCcsXG4gICAgKTtcbiAgICBleHBlY3QobW9ja0ludGVydmFsQ2hhbm5lbEZuKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChpbnRlcnZhbCk7XG4gICAgZXhwZWN0KGV2ZW50Q2hhbm5lbCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ2hhbmRsZXJGbicpO1xuICB9KTtcblxuICBpdCgnaW50ZXJ2YWxDaGFubmVsRm4gYWRoZXJlcyB0byBldmVudENoYW5uZWwgY2IgaW50ZXJmYWNlJywgZG9uZSA9PiB7XG4gICAgZ2xvYmFsLmNsZWFySW50ZXJ2YWwgPSBqZXN0LmZuKCk7XG4gICAgY29uc3QgZW1pdE1vY2sgPSBqZXN0LmZuKCk7XG4gICAgY29uc3QgdW5zdWJzY3JpYmUgPSBpbnRlcnZhbENoYW5uZWxGbihpbnRlcnZhbCkoZW1pdE1vY2spO1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgZXhwZWN0KGVtaXRNb2NrKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh0cnVlKTtcbiAgICAgIGRvbmUoKTtcbiAgICB9LCBpbnRlcnZhbCArIDIwKTtcbiAgICB1bnN1YnNjcmliZSgpO1xuICAgIGV4cGVjdChnbG9iYWwuY2xlYXJJbnRlcnZhbCkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9